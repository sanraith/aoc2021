!function(){"use strict";var t={521:function(t,n,e){var r,i,o=e(7762),a=e(5861),u=e(7757),s=e.n(u),c=e(1435),l=e(9591),f=e(5671),h=e(3144),p=e(3324),v=e(136),g=e(9388),d=e(874),y=e(6043),m=function t(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,f.Z)(this,t),this.part=n,this.progress=e,this.timeMs=r,this.kind="progress"},k=function t(n,e,r,i){(0,f.Z)(this,t),this.part=n,this.result=e,this.timeMs=r,this.visualizationData=i,this.kind="result"},w=function t(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,f.Z)(this,t),this.part=n,this.message=e,this.timeMs=r,this.kind="error"},b=function(){function t(){(0,f.Z)(this,t),this.minTimeBetweenUpdatesMs=20,this.visualizationData=void 0,this._input=void 0,this._inputLines=void 0,this.currentSolution=void 0}return(0,h.Z)(t,[{key:"input",get:function(){var t;return null!==(t=this._input)&&void 0!==t?t:""}},{key:"inputLines",get:function(){return void 0===this._inputLines&&(this._inputLines=this.parseInputLines(this.input)),this._inputLines}},{key:"init",value:function(t){return this._input=t,this}},{key:"solveAsync",value:function(){var t=(0,a.Z)(s().mark((function t(n){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,c.n)(this.solveWithProgress(n));case 2:e=t.sent,t.t0=e.kind,t.next="result"===t.t0?6:7;break;case 6:return t.abrupt("return",e.result);case 7:return t.abrupt("return",null);case 8:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}()},{key:"solveWithProgress",value:function(t){var n=this;return new d.y((function(e){if(n._input)if(n.currentSolution)e.error(new w(t,"Another solution is already in progress!"));else{var r=1===t?n.part1:n.part2;n.currentSolution={activePart:t,subscriber:e,stopwatch:new y.u,progressStopwatch:new y.u},n.visualizationData=null,n.currentSolution.stopwatch.start(),n.currentSolution.progressStopwatch.start();try{var i=r.apply(n)+"",o=n.currentSolution.stopwatch.stop(),a=new k(t,i,o,n.visualizationData);e.next(a)}catch(c){var u,s=null!==(u=n.currentSolution.stopwatch.stop())&&void 0!==u?u:0;e.next(new w(t,c+"",s))}finally{e.complete(),n.visualizationData=null,n.currentSolution=void 0}}else e.error(new w(t,"No input provided!"))}))}},{key:"updateProgress",value:function(t){var n=this.currentSolution;n&&n.progressStopwatch.getTime()>this.minTimeBetweenUpdatesMs&&(n.subscriber.next(new m(n.activePart,t,n.stopwatch.getTime())),n.progressStopwatch.start(!0))}},{key:"noSolution",value:function(t){throw new Error(t)}},{key:"parseInputLines",value:function(t){var n,e=t.split(/\r\n?|\n/g),r=/^\s*$/gm;for(n=0;n<e.length;n++){var i=e[e.length-n-1];if(!r.test(i))break}return e.splice(e.length-n,n),e}}]),t}(),S=e(1413),x=[];r=function(){var t="number"===typeof(arguments.length<=0?void 0:arguments[0])?{day:arguments.length<=0?void 0:arguments[0],title:arguments.length<=1?void 0:arguments[1]}:arguments.length<=0?void 0:arguments[0];return function(n){x.push((0,S.Z)((0,S.Z)({},t),{},{ctor:n,create:function(){return new n}}))}}({day:22,title:"Crab Combat"}),r(i=function(t){(0,v.Z)(e,t);var n=(0,g.Z)(e);function e(){var t;(0,f.Z)(this,e);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=n.call.apply(n,[this].concat(i))).isLogEnabled=!1,t.gameCount=void 0,t}return(0,h.Z)(e,[{key:"part1",value:function(){var t=this.parseDecks();return this.playGame(t,{isRecursive:!1}),this.part2(),this.calculateScore(t)}},{key:"part2",value:function(){var t=this.parseDecks();return this.playGame(t,{isRecursive:!0}),this.calculateScore(t)}},{key:"calculateScore",value:function(t){return t.filter((function(t){return t.length>0}))[0].reverse().reduce((function(t,n,e){return t+n*(e+1)}),0)}},{key:"playGame",value:function(t,n){var e=this,r=new Set,i=++this.gameCount,o=0;this.isLogEnabled&&console.log("\n== Game ".concat(i," =="));for(var a=function(){o++,1===i&&e.updateProgress(Math.max(t[0].length,t[1].length)/(t[0].length+t[1].length)),e.isLogEnabled&&(console.log("\n-- Round ".concat(o," (Game ").concat(i,") --")),t.forEach((function(t,n){return console.log("Player ".concat(n+1,"'s deck: ").concat(t.join(", ")))})));var a=e.getState(t);if(r.has(a))return{v:0};r.add(a);var u=t.map((function(t){return t.shift()})),s=(0,p.Z)(u,2),c=s[0],l=s[1];e.isLogEnabled&&u.forEach((function(t,n){return console.log("Player ".concat(n+1," plays: ").concat(t))}));var f=c>l?0:1;if(n.isRecursive&&t[0].length>=c&&t[1].length>=l){e.isLogEnabled&&console.log("Playing a sub-game to determine a winner...");var h=t.map((function(t,n){return t.slice(0,u[n])}));f=e.playGame(h,n),e.isLogEnabled&&console.log("\n...anyway, back to game ".concat(i,"."))}0===f?t[0].push(c,l):t[1].push(l,c),e.isLogEnabled&&console.log("Player ".concat(f+1," wins round ").concat(o," of game ").concat(i,"!"))};t[0].length>0&&t[1].length>0;){var u=a();if("object"===typeof u)return u.v}var s=t.findIndex((function(t){return t.length>0}));return this.isLogEnabled&&(console.log("The winner of game ".concat(i," is player ").concat(s+1,"!")),1===i&&(console.log("\n\n== Post-game results =="),t.forEach((function(t,n){return console.log("Player ".concat(n+1,"'s deck: ").concat(t.join(", ")))})))),s}},{key:"getState",value:function(t){return t[0].join(",")+"|"+t[1].join(",")}},{key:"parseDecks",value:function(){for(var t,n=[],e=0,r=0;r<2;r++){e++;for(var i=[];(t=this.inputLines[e++])&&t.length>0;)i.push(parseInt(t));n.push(i)}return this.gameCount=0,n}}]),e}(b));var L=(new(function(){function t(){(0,f.Z)(this,t)}return(0,h.Z)(t,[{key:"getSolutionsByDay",value:function(){return new Map(x.map((function(t){return[t.day,t]})))}},{key:"getSolutions",value:function(){return Array.from(this.getSolutionsByDay().values()).sort((function(t,n){return t.day-n.day}))}}]),t}())).getSolutionsByDay();addEventListener("message",function(){var t=(0,a.Z)(s().mark((function t(n){var e,r,i,a,u,f,h;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.data,r=L.get(e.day)){t.next=4;break}return t.abrupt("return");case 4:(i=r.create()).init(e.input),a=(0,o.Z)([1,2]),t.prev=7,a.s();case 9:if((u=a.n()).done){t.next=16;break}return f=u.value,h=i.solveWithProgress(f),t.next=14,(0,c.n)(h.pipe((0,l.b)((function(t){return postMessage(t)}))));case 14:t.next=9;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(7),a.e(t.t0);case 21:return t.prev=21,a.f(),t.finish(21);case 24:postMessage(new k(-1,null,0));case 25:case"end":return t.stop()}}),t,null,[[7,18,21,24]])})));return function(n){return t.apply(this,arguments)}}())}},n={};function e(r){var i=n[r];if(void 0!==i)return i.exports;var o=n[r]={exports:{}};return t[r](o,o.exports,e),o.exports}e.m=t,e.x=function(){var t=e.O(void 0,[487],(function(){return e(521)}));return t=e.O(t)},function(){var t=[];e.O=function(n,r,i,o){if(!r){var a=1/0;for(l=0;l<t.length;l++){r=t[l][0],i=t[l][1],o=t[l][2];for(var u=!0,s=0;s<r.length;s++)(!1&o||a>=o)&&Object.keys(e.O).every((function(t){return e.O[t](r[s])}))?r.splice(s--,1):(u=!1,o<a&&(a=o));if(u){t.splice(l--,1);var c=i();void 0!==c&&(n=c)}}return n}o=o||0;for(var l=t.length;l>0&&t[l-1][2]>o;l--)t[l]=t[l-1];t[l]=[r,i,o]}}(),e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},e.d=function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.f={},e.e=function(t){return Promise.all(Object.keys(e.f).reduce((function(n,r){return e.f[r](t,n),n}),[]))},e.u=function(t){return"static/js/"+t+".8dc0e7a2.chunk.js"},e.miniCssF=function(t){},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="/aoc2021/",function(){var t={521:1};e.f.i=function(n,r){t[n]||importScripts(e.p+e.u(n))};var n=self.webpackChunkaoc2021=self.webpackChunkaoc2021||[],r=n.push.bind(n);n.push=function(n){var i=n[0],o=n[1],a=n[2];for(var u in o)e.o(o,u)&&(e.m[u]=o[u]);for(a&&a(e);i.length;)t[i.pop()]=1;r(n)}}(),function(){var t=e.x;e.x=function(){return e.e(487).then(t)}}();e.x()}();
//# sourceMappingURL=521.3e66a447.chunk.js.map